global
  log /dev/log local0
  log /dev/log local1 notice
  chroot /var/lib/haproxy
  stats socket /run/haproxy/admin.sock mode 660 level admin expose-fd listeners
  stats timeout 30s
  user haproxy
  group haproxy
  daemon

defaults
  log     global
  mode    tcp
  option  tcplog
  option  dontlognull
  timeout connect 10s
  timeout client  1m
  timeout server  1m

frontend kubernetes-frontend
  bind *:6443
  default_backend kubernetes-backend

backend kubernetes-backend
  option httpchk GET /healthz
  http-check expect status 200
  default-server inter 3s fall 3 rise 2
  server master1 10.17.4.21:6443 check
  server master2 10.17.4.22:6443 check
  server master3 10.17.4.23:6443 check